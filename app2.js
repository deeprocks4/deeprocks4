function isRunningLocally(){return/^localhost/.test(window.location.host)}function connectToChatServer(){console.log("Connecting to chat server. AccessToken:",worldStore.state.accessToken),socket=io(config.chat_uri),socket.on("connect",function(){console.log("[socket] Connected"),socket.on("disconnect",function(){console.log("[socket] Disconnected")}),socket.on("unconfirmed_balance_change",function(e){console.log("[socket] unconfirmed_balance_change:",e),Dispatcher.sendAction("UPDATE_USER",{unconfirmed_balance:e.balance})}),socket.on("balance_change",function(e){console.log("[socket] (confirmed) balance_change:",e),Dispatcher.sendAction("UPDATE_USER",{balance:e.balance})}),socket.on("new_message",function(e){console.log("[socket] Received chat message:",e),Dispatcher.sendAction("NEW_MESSAGE",e)}),socket.on("user_joined",function(e){console.log("[socket] User joined:",e),Dispatcher.sendAction("USER_JOINED",e)}),socket.on("user_left",function(e){console.log("[socket] User left:",e),Dispatcher.sendAction("USER_LEFT",e)}),socket.on("new_bet",function(e){if("ALL_BETS"==worldStore.state.currTab){if(console.log("[socket] New bet:",e),"simple_dice"!==e.kind)return void console.log("[weird] received bet from socket that was NOT a simple_dice bet");Dispatcher.sendAction("NEW_ALL_BET",e)}}),socket.on("client_error",function(e){console.warn("[socket] Client error:",e)});var e={app_id:config.app_id,access_token:worldStore.state.accessToken,subscriptions:["CHAT","DEPOSITS","BETS"]};socket.emit("auth",e,function(e,t){return e?void console.log("[socket] Auth failure:",e):(console.log("[socket] Auth success:",t),void Dispatcher.sendAction("INIT_CHAT",t))})})}function onRecaptchaLoad(){Dispatcher.sendAction("GRECAPTCHA_LOADED",grecaptcha)}var config={app_id:1005,app_name:"Awesome Dice",recaptcha_sitekey:"6LcR5x0TAAAAAFSSsTDZ6x9VXC9qyb4QmvVkbv-d",redirect_uri:"http://awesomedice.net",mp_browser_uri:"https://www.moneypot.com",mp_api_uri:"https://api.moneypot.com",chat_uri:"https://socket.moneypot.com",debug:isRunningLocally(),force_https_redirect:!1,house_edge:.009,chat_buffer_size:250,bet_buffer_size:25};!function(){var e;if(config.house_edge<=0?e="House edge must be > 0.0 (0%)":config.house_edge>=100&&(e="House edge must be < 1.0 (100%)"),e)throw alert(e),new Error(e);console.log("House Edge:",(100*config.house_edge).toString()+"%")}(),config.force_https_redirect&&"https:"!==window.location.protocol&&(window.location.href="https:"+window.location.href.substring(window.location.protocol.length));var socket,el=React.DOM,genUuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)})},helpers={};helpers.formatDateToTime=function(e){var t=new Date(e);return _.padLeft(t.getHours().toString(),2,"0")+":"+_.padLeft(t.getMinutes().toString(),2,"0")+":"+_.padLeft(t.getSeconds().toString(),2,"0")},helpers.multiplierToWinProb=function(e){console.assert("number"==typeof e),console.assert(e>0);var t=1-config.house_edge;return t/e},helpers.calcNumber=function(e,t){return console.assert("<"===e||">"===e),console.assert("number"==typeof t),"<"===e?100*t:99.99-100*t},helpers.roleToLabelElement=function(e){switch(e){case"ADMIN":return el.span({className:"label label-danger"},"MP Staff");case"MOD":return el.span({className:"label label-info"},"Mod");case"OWNER":return el.span({className:"label label-primary"},"Owner");default:return""}},helpers.getHashParams=function(){for(var e,t={},n=/\+/g,a=/([^&;=]+)=?([^&;]*)/g,o=function(e){return decodeURIComponent(e.replace(n," "))},r=window.location.hash.substring(1);e=a.exec(r);)t[o(e[1])]=o(e[2]);return t},helpers.getPrecision=function(e){var t=(""+e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0},helpers.decimalAdjust=function(e,t,n){return"undefined"==typeof n||0===+n?Math[e](t):(t=+t,n=+n,isNaN(t)||"number"!=typeof n||n%1!==0?NaN:(t=t.toString().split("e"),t=Math[e](+(t[0]+"e"+(t[1]?+t[1]-n:-n))),t=t.toString().split("e"),+(t[0]+"e"+(t[1]?+t[1]+n:n))))},helpers.round10=function(e,t){return helpers.decimalAdjust("round",e,t)},helpers.floor10=function(e,t){return helpers.decimalAdjust("floor",e,t)},helpers.ceil10=function(e,t){return helpers.decimalAdjust("ceil",e,t)},helpers.numberWithCommas=function(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")};var MoneyPot=function(){var e={};e.apiVersion="v1";var t=function(){},n=function(n,a,o,r,s){if(!worldStore.state.accessToken)throw new Error("Must have accessToken set to call MoneyPot API");var l=config.mp_api_uri+"/"+e.apiVersion+o;worldStore.state.accessToken&&(l=l+"?access_token="+worldStore.state.accessToken);var i={url:l,dataType:"json",method:n,data:a?JSON.stringify(a):void 0,headers:{"Content-Type":"text/plain"},success:r.success||t,error:r.error||t,complete:r.complete||t};$.ajax(_.merge({},i,s||{}))};return e.listBets=function(e,t){var a="/list-bets";n("GET",void 0,a,t,{data:e})},e.getTokenInfo=function(e){var t="/token";n("GET",void 0,t,e)},e.generateBetHash=function(e){var t="/hashes";n("POST",void 0,t,e)},e.getDepositAddress=function(e){var t="/deposit-address";n("GET",void 0,t,e)},e.claimFaucet=function(e,t){console.log("Hitting POST /claim-faucet");var a="/claim-faucet",o={response:e};n("POST",o,a,t)},e.placeSimpleDiceBet=function(e,t){var a="/bets/simple-dice";n("POST",e,a,t)},e.tip=function(e,t){var a="/tip";n("POST",e,a,t)},e.getMPBankRoll=function(e){var t="/bankroll";n("GET",void 0,t,e)},e}(),Dispatcher=new function(){this.callbacks={};var e=this;this.registerCallback=function(t,n){console.log("[Dispatcher] registering callback for:",t),e.callbacks[t]?e.callbacks[t].push(n):e.callbacks[t]=[n]},this.sendAction=function(t,n){if(console.log("[Dispatcher] received action:",t,n),!e.callbacks[t])throw new Error("Unsupported actionName: "+t);e.callbacks[t].forEach(function(e){e(n)})}},Store=function(e,t,n){this.state=t,this.emitter=new EventEmitter,n.call(this);var a=this;this.on=function(e,t){a.emitter.on(e,t)},this.off=function(e,t){a.emitter.off(e,t)}},access_token,expires_in,expires_at;helpers.getHashParams().access_token?(console.log("[token manager] access_token in hash params"),access_token=helpers.getHashParams().access_token,expires_in=helpers.getHashParams().expires_in,expires_at=new Date(Date.now()+1e3*expires_in),localStorage.setItem("access_token",access_token),localStorage.setItem("expires_at",expires_at)):localStorage.access_token?(console.log("[token manager] access_token in localStorage"),expires_at=localStorage.expires_at,expires_at&&new Date(expires_at)>new Date(Date.now()+6048e5)?access_token=localStorage.access_token:(localStorage.removeItem("expires_at"),localStorage.removeItem("access_token"))):console.log("[token manager] no access token");var chatStore=new Store("chat",{messages:new CBuffer(config.chat_buffer_size),waitingForServer:!1,userList:{},showUserList:!1,loadingInitialMessages:!0,atUname:"@test, "},function(){var e=this;Dispatcher.registerCallback("INIT_CHAT",function(t){console.log("[ChatStore] received INIT_CHAT");var n=t.chat.messages.map(function(e){return e.id=genUuid(),e});e.state.messages.empty(),e.state.messages.push.apply(e.state.messages,n),e.state.loadingInitialMessages=!1,e.state.userList=t.chat.userlist,e.emitter.emit("change",e.state),e.emitter.emit("init")}),Dispatcher.registerCallback("NEW_MESSAGE",function(t){console.log("[ChatStore] received NEW_MESSAGE"),t.id=genUuid(),e.state.messages.push(t),e.state.waitingForServer=!1,e.emitter.emit("change",e.state),e.emitter.emit("new_message")}),Dispatcher.registerCallback("TOGGLE_CHAT_USERLIST",function(){console.log("[ChatStore] received TOGGLE_CHAT_USERLIST"),e.state.showUserList=!e.state.showUserList,e.emitter.emit("change",e.state)}),Dispatcher.registerCallback("USER_JOINED",function(t){console.log("[ChatStore] received USER_JOINED:",t),e.state.userList[t.uname]=t,e.emitter.emit("change",e.state)}),Dispatcher.registerCallback("USER_LEFT",function(t){console.log("[ChatStore] received USER_LEFT:",t),delete e.state.userList[t.uname],e.emitter.emit("change",e.state)}),Dispatcher.registerCallback("ADD_AT_USERNAME",function(t){e.state.atUname="@"+t+", ",e.emitter.emit("change",e.state),e.emitter.emit("add_at_username",e.state)}),Dispatcher.registerCallback("SEND_MESSAGE",function(t){if("/tip"==t.substring(0,4)){var n=t.split(" "),a={uname:n[1],amount:100*parseInt(n[2])};return void MoneyPot.tip(a,{success:function(){console.log("Successfully placed tip:",a.uname," ",a.amount),Dispatcher.sendAction("SEND_MESSAGE","Successfully tipped "+a.uname+" "+(parseFloat(a.amount)/100).toFixed(0)+" bits")},error:function(e){console.log("Error"),e.responseJSON&&e.responseJSON?Dispatcher.sendAction("SEND_MESSAGE",e.responseJSON.error):Dispatcher.sendAction("SEND_MESSAGE","Internal Error")},complete:function(){Dispatcher.sendAction("START_REFRESHING_USER")}})}if("/help"==t.substring(0,5)){var o=new Date,r="Commands available:\\n\\tip [user] [amount]\\nnew commands coming soon",s={channel:"Lobby",text:r,created_at:o.toJSON(),user:{role:"BOT",uname:"HELP"}};return void Dispatcher.sendAction("NEW_MESSAGE",s)}if("/"==t.substring(0,1)){var o=new Date,r="Chat command not recognized",s={channel:"Lobby",text:r,created_at:o.toJSON(),user:{role:"BOT",uname:"?"}};return void Dispatcher.sendAction("NEW_MESSAGE",s)}console.log("[ChatStore] received SEND_MESSAGE"),e.state.waitingForServer=!0,e.emitter.emit("change",e.state),socket.emit("new_message",{text:t},function(e){e&&alert("Chat Error: "+e)})})}),firstSeed=Math.floor(Math.random()*(Math.pow(2,32)-1)),betStore=new Store("bet",{nextHash:void 0,wager:{str:"1",num:1,error:void 0},multiplier:{str:"2.00",num:2,error:void 0},clientseed:{str:firstSeed.toString(),num:firstSeed,randomizelock:!1,error:void 0},hotkeysEnabled:!1},function(){var e=this;Dispatcher.registerCallback("SET_NEXT_HASH",function(t){e.state.nextHash=t,e.emitter.emit("change",e.state)}),Dispatcher.registerCallback("UPDATE_WAGER",function(t){e.state.wager=_.merge({},e.state.wager,t);var n=parseInt(e.state.wager.str,10);isFinite(n)&&(n=Math.max(n,1),e.state.wager.str=n.toString()),isNaN(n)||/[^\d]/.test(n.toString())?e.state.wager.error="INVALID_WAGER":100*n>worldStore.state.user.balance?(e.state.wager.error="CANNOT_AFFORD_WAGER",e.state.wager.num=n):(e.state.wager.error=null,e.state.wager.str=n.toString(),e.state.wager.num=n),e.emitter.emit("change",e.state)}),Dispatcher.registerCallback("UPDATE_MULTIPLIER",function(t){e.state.multiplier=_.merge({},e.state.multiplier,t),e.emitter.emit("change",e.state)}),Dispatcher.registerCallback("UPDATE_CLIENT_SEED",function(t){e.state.clientseed=_.merge({},e.state.clientseed,t),e.emitter.emit("change",e.state)}),Dispatcher.registerCallback("TOGGLE_LOCK_RND",function(){e.state.clientseed.randomizelock=!e.state.clientseed.randomizelock,e.emitter.emit("change",e.state)})}),worldStore=new Store("world",{isLoading:!0,user:void 0,accessToken:access_token,isRefreshingUser:!1,hotkeysEnabled:!1,currTab:"ALL_BETS",bets:new CBuffer(config.bet_buffer_size),allBets:new CBuffer(config.bet_buffer_size),grecaptcha:void 0,mpBankRoll:0},function(){var e=this;Dispatcher.registerCallback("UPDATE_USER",function(t){e.state.user=_.merge({},e.state.user,t),e.emitter.emit("change",e.state)}),Dispatcher.registerCallback("USER_LOGIN",function(t){e.state.user=t,e.emitter.emit("change",e.state),e.emitter.emit("user_update")}),Dispatcher.registerCallback("USER_LOGOUT",function(){e.state.user=void 0,e.state.accessToken=void 0,localStorage.removeItem("expires_at"),localStorage.removeItem("access_token"),e.state.bets.empty(),e.emitter.emit("change",e.state)}),Dispatcher.registerCallback("START_LOADING",function(){e.state.isLoading=!0,e.emitter.emit("change",e.state)}),Dispatcher.registerCallback("STOP_LOADING",function(){e.state.isLoading=!1,e.emitter.emit("change",e.state)}),Dispatcher.registerCallback("CHANGE_TAB",function(t){console.assert("string"==typeof t),e.state.currTab=t,e.emitter.emit("change",e.state)}),Dispatcher.registerCallback("NEW_BET",function(t){console.assert("object"==typeof t),e.state.bets.push(t),e.emitter.emit("new_my_bet",e.state)}),Dispatcher.registerCallback("NEW_ALL_BET",function(t){e.state.allBets.push(t),e.emitter.emit("new_all_bet",e.state)}),Dispatcher.registerCallback("INIT_ALL_BETS",function(t){console.assert(_.isArray(t)),e.state.allBets.push.apply(e.state.allBets,t),e.emitter.emit("change",e.state)}),Dispatcher.registerCallback("TOGGLE_HOTKEYS",function(){e.state.hotkeysEnabled=!e.state.hotkeysEnabled,e.emitter.emit("change",e.state)}),Dispatcher.registerCallback("DISABLE_HOTKEYS",function(){e.state.hotkeysEnabled=!1,e.emitter.emit("change",e.state)}),Dispatcher.registerCallback("START_REFRESHING_USER",function(){e.state.isRefreshingUser=!0,e.emitter.emit("change",e.state),MoneyPot.getTokenInfo({success:function(t){console.log("Successfully loaded user from tokens endpoint",t);var n=t.auth.user;e.state.user=n,e.emitter.emit("change",e.state),e.emitter.emit("user_update")},error:function(e){console.log("Error:",e)},complete:function(){Dispatcher.sendAction("STOP_REFRESHING_USER")}})}),Dispatcher.registerCallback("STOP_REFRESHING_USER",function(){e.state.isRefreshingUser=!1,e.emitter.emit("change",e.state)}),Dispatcher.registerCallback("GRECAPTCHA_LOADED",function(t){e.state.grecaptcha=t,e.emitter.emit("grecaptcha_loaded")}),Dispatcher.registerCallback("UPDATE_MP_BANKROLL",function(){e.emitter.emit("change",e.state),MoneyPot.getMPBankRoll({success:function(t){console.log("Successfully loaded bank roll: ",t),e.state.mpBankRoll=t.balance},error:function(e){console.log("Error:",e)},complete:function(){}})})}),UserBoxOld=React.createClass({displayName:"UserBoxOld",_onStoreChange:function(){this.forceUpdate()},componentDidMount:function(){worldStore.on("change",this._onStoreChange)},componentWillUnount:function(){worldStore.off("change",this._onStoreChange)},_onLogout:function(){Dispatcher.sendAction("USER_LOGOUT")},render:function(){var e;return e=worldStore.state.isLoading?el.p({className:"navbar-text"},"Loading..."):worldStore.state.user?el.div(null,el.span({className:"navbar-text"},"Logged in as ",el.code(null,worldStore.state.user.uname)),el.button({type:"button",onClick:this._onLogout,className:"navbar-btn btn btn-default"},"Logout")):el.p({className:"navbar-text"},el.a({href:config.mp_browser_uri+"/oauth/authorize?app_id="+config.app_id+"&redirect_uri="+config.redirect_uri,className:"btn btn-default"},"Login with Moneypot")),el.div({className:"navbar-right"},e)}}),UserBox=React.createClass({displayName:"UserBox",_onStoreChange:function(){this.forceUpdate()},componentDidMount:function(){worldStore.on("change",this._onStoreChange)},componentWillUnount:function(){worldStore.off("change",this._onStoreChange)},_onLogout:function(){Dispatcher.sendAction("USER_LOGOUT")},render:function(){var e;return worldStore.state.isLoading?(e=el.div({className:"row child"},el.div({className:"col-sm-12 text-center"},"Loading...")),el.div({className:"tile-inner parent"},e)):worldStore.state.user?(e=el.div({className:"row"},el.div({className:"col-sm-6 text-center"},el.span(null,"Name: ",el.code(null,worldStore.state.user.uname))),el.div({className:"col-sm-6 text-center"},el.button({type:"button",onClick:this._onLogout,className:"btn btn-default-custom btn-xs"},"Logout"))),el.div({className:"tile-row-inner parent"},e)):(e=el.div({className:"row child"},el.div({className:"col-sm-6 text-center"},el.a({href:"http://awesomedice.net/redirect",className:"btn btn-default-custom"},"Login")),el.div({className:"col-sm-6 text-center"},el.a({href:config.mp_browser_uri+"/register?app_id="+config.app_id,className:"btn btn-default-custom"},"Register"))),el.div({className:"tile-inner parent"},e))}}),BalanceBoxOld=React.createClass({displayName:"BalanceBoxOld",_onStoreChange:function(){this.forceUpdate()},componentDidMount:function(){worldStore.on("change",this._onStoreChange),betStore.on("change",this._onStoreChange)},componentWillUnount:function(){worldStore.off("change",this._onStoreChange),betStore.off("change",this._onStoreChange)},_onRefreshUser:function(){Dispatcher.sendAction("START_REFRESHING_USER")},_openWithdrawPopup:function(){var e=config.mp_browser_uri+"/dialog/withdraw?app_id="+config.app_id,t="manage-auth",n=["width=420","height=350","left=100","top=100"].join(","),a=window.open(e,t,n);return a.focus(),!1},_openDepositPopup:function(){var e=config.mp_browser_uri+"/dialog/deposit?app_id="+config.app_id,t="manage-auth",n=["width=420","height=350","left=100","top=100"].join(","),a=window.open(e,t,n);return a.focus(),!1},render:function(){var e;return worldStore.state.isLoading?e=el.p({className:"navbar-text"},"Loading..."):worldStore.state.user&&(e=el.div(null,el.div({className:"btn-group navbar-left btn-group-xs"},el.button({type:"button",className:"btn navbar-btn btn-xs "+("CANNOT_AFFORD_WAGER"===betStore.state.wager.error?"btn-success":"btn-default"),onClick:this._openDepositPopup},"Deposit"),el.button({type:"button",className:"btn btn-default navbar-btn btn-xs",onClick:this._openWithdrawPopup},"Withdraw")),el.span({id:"bot-bal",className:"navbar-text",style:{marginRight:"5px"}},helpers.numberWithCommas(worldStore.state.user.balance/100)+" bits",worldStore.state.user.unconfirmed_balance?el.span({style:{color:"#e67e22"}}," + "+helpers.numberWithCommas(worldStore.state.user.unconfirmed_balance/100)+" bits pending"):""),el.button({className:"btn btn-link navbar-btn navbar-left "+(worldStore.state.isRefreshingUser?" rotate":""),title:"Refresh Balance",disabled:worldStore.state.isRefreshingUser,onClick:this._onRefreshUser,style:{paddingLeft:0,paddingRight:0,marginRight:"10px"}},el.span({className:"glyphicon glyphicon-refresh"})))),el.div({className:"navbar-right"},e)}}),BalanceBox=React.createClass({displayName:"BalanceBox",_onStoreChange:function(){this.forceUpdate()},componentDidMount:function(){worldStore.on("change",this._onStoreChange),betStore.on("change",this._onStoreChange)},componentWillUnount:function(){worldStore.off("change",this._onStoreChange),betStore.off("change",this._onStoreChange)},_onRefreshUser:function(){Dispatcher.sendAction("START_REFRESHING_USER")},_openWithdrawPopup:function(){var e=config.mp_browser_uri+"/dialog/withdraw?app_id="+config.app_id,t="manage-auth",n=["width=420","height=350","left=100","top=100"].join(","),a=window.open(e,t,n);return a.focus(),!1},_openDepositPopup:function(){var e=config.mp_browser_uri+"/dialog/deposit?app_id="+config.app_id,t="manage-auth",n=["width=420","height=350","left=100","top=100"].join(","),a=window.open(e,t,n);return a.focus(),!1},render:function(){var e,t;return worldStore.state.isLoading?e=el.p(null," "):worldStore.state.user&&(e=el.div({className:"row text-center",style:{marginTop:"5px"}},el.div({className:"btn-group btn-group-xs"},el.button({type:"button",className:"btn btn-xs "+("CANNOT_AFFORD_WAGER"===betStore.state.wager.error?"btn-success":"btn-default-custom"),onClick:this._openDepositPopup},"Deposit"),el.button({type:"button",className:"btn btn-default-custom btn-xs",onClick:this._openWithdrawPopup},"Withdraw"))),t=el.div({className:"row"},el.span({id:"bot-bal"},"Balance: "+helpers.numberWithCommas(worldStore.state.user.balance/100)+" bits ",worldStore.state.user.unconfirmed_balance?el.span({style:{color:"#4d4d4d"}},"+ "+helpers.numberWithCommas(worldStore.state.user.unconfirmed_balance/100)+" pending"):""),el.button({className:"btn btn-link btn-xs"+(worldStore.state.isRefreshingUser?" rotate":""),title:"Refresh Balance",disabled:worldStore.state.isRefreshingUser,onClick:this._onRefreshUser,style:{paddingLeft:0,paddingRight:0,marginRight:"10px"}},el.span({className:"glyphicon glyphicon-refresh"})))),el.div({className:"tile-row-inner"},t,e)}}),Navbar=React.createClass({displayName:"Navbar",render:function(){return el.div({className:"navbar"},el.div({className:"container-fluid"},el.div({className:"navbar-header"},el.a({href:"/"},el.img({src:"logoNavBar.png"}))),el.ul({className:"nav navbar-nav"},el.li(null,el.a({href:config.mp_browser_uri+"/apps/"+config.app_id,target:"_blank"},"View on Moneypot ",el.span({className:"glyphicon glyphicon-new-window"})))),React.createElement(UserBox,null)))}}),Logo=React.createClass({displayName:"Logo",render:function(){return el.div(null,el.a({href:"/"},el.img({src:"logo.png",width:"100%"})),el.div({id:"vertical-ticker"},el.ul(null,el.li(null,"Welcome to Awesome Dice"),el.li(null,"New feature coming: Jackpot"),el.li(null,"Happy betting!"))))}}),ChatBoxInputOld=React.createClass({displayName:"ChatBoxInputOld",_onStoreChange:function(){this.forceUpdate()},_onAddUname:function(){this.state.text+=chatStore.state.atUname},componentDidMount:function(){chatStore.on("change",this._onStoreChange),worldStore.on("change",this._onStoreChange),chatStore.on("add_at_username",this._onAddUname)},componentWillUnmount:function(){chatStore.off("change",this._onStoreChange),worldStore.off("change",this._onStoreChange),chatStore.off("add_at_username",this._onAddUname)},getInitialState:function(){return{text:""}},_onChange:function(e){this.setState({text:e.target.value})},_onSend:function(){Dispatcher.sendAction("SEND_MESSAGE",this.state.text),this.setState({text:""})},_onFocus:function(){worldStore.state.hotkeysEnabled&&Dispatcher.sendAction("DISABLE_HOTKEYS")},_onKeyPress:function(e){var t=13;e.which===t&&this.state.text.trim().length>0&&this._onSend()},render:function(){return el.div({className:"row"},el.div({className:"col-md-9"},chatStore.state.loadingInitialMessages?el.div({style:{marginTop:"7px"},className:"text-muted"},el.span({className:"glyphicon glyphicon-refresh rotate"})," Loading..."):el.input({id:"chat-input",className:"form-control",type:"text",value:this.state.text,placeholder:worldStore.state.user?"Click here and begin typing...":"Login to chat",onChange:this._onChange,onKeyPress:this._onKeyPress,onFocus:this._onFocus,ref:"input",disabled:!worldStore.state.user||chatStore.state.loadingInitialMessages})),el.div({className:"col-md-3"},el.button({type:"button",className:"btn btn-default btn-block",disabled:!worldStore.state.user||chatStore.state.waitingForServer||0===this.state.text.trim().length,onClick:this._onSend},"Send")))}}),ChatBoxInput=React.createClass({displayName:"ChatBoxInput",_onStoreChange:function(){this.forceUpdate()},_onAddUname:function(){this.state.text+=chatStore.state.atUname},componentDidMount:function(){chatStore.on("change",this._onStoreChange),worldStore.on("change",this._onStoreChange),chatStore.on("add_at_username",this._onAddUname)},componentWillUnmount:function(){chatStore.off("change",this._onStoreChange),worldStore.off("change",this._onStoreChange),chatStore.off("add_at_username",this._onAddUname)},getInitialState:function(){return{text:""}},_onChange:function(e){this.setState({text:e.target.value})},_onSend:function(){Dispatcher.sendAction("SEND_MESSAGE",this.state.text),this.setState({text:""})},_onFocus:function(){worldStore.state.hotkeysEnabled&&Dispatcher.sendAction("DISABLE_HOTKEYS")},_onKeyPress:function(e){var t=13;e.which===t&&this.state.text.trim().length>0&&this._onSend()},render:function(){return el.div({className:"row"},el.div({className:"col-md-9"},chatStore.state.loadingInitialMessages?el.div({style:{marginTop:"7px"},className:"text-muted"},el.span({className:"glyphicon glyphicon-refresh rotate"})," Loading..."):el.input({id:"chat-input",className:"form-control input-sm block",type:"text",value:this.state.text,placeholder:worldStore.state.user?"Type here... Type /help for commands":"Login to chat",onChange:this._onChange,onKeyPress:this._onKeyPress,onFocus:this._onFocus,ref:"input",disabled:!worldStore.state.user||chatStore.state.loadingInitialMessages})),el.div({className:"col-md-3"},el.button({type:"button",className:"btn btn-default-custom btn-sm",disabled:!worldStore.state.user||chatStore.state.waitingForServer||0===this.state.text.trim().length,onClick:this._onSend},"Send")))}}),ChatUserList=React.createClass({displayName:"ChatUserList",render:function(){return el.div({className:"panel panel-default"},el.div({className:"panel-heading"},"UserList"),el.div({className:"panel-body"},el.ul({},_.values(chatStore.state.userList).map(function(e){return el.li({key:e.uname},helpers.roleToLabelElement(e.role)," "+e.uname)}))))}}),ChatBoxOld=React.createClass({displayName:"ChatBoxOld",_onStoreChange:function(){this.forceUpdate()},_onNewMessage:function(){var e=this.refs.chatListRef.getDOMNode(),t=function(){var t=e.scrollHeight-($(e).scrollTop()+$(e).innerHeight());return console.log("DistanceFromBottom:",t),100>=t};t()&&this._scrollChat()},_scrollChat:function(){var e=this.refs.chatListRef.getDOMNode();$(e).scrollTop(e.scrollHeight)},componentDidMount:function(){chatStore.on("change",this._onStoreChange),chatStore.on("new_message",this._onNewMessage),chatStore.on("init",this._scrollChat)},componentWillUnmount:function(){chatStore.off("change",this._onStoreChange),chatStore.off("new_message",this._onNewMessage),chatStore.off("init",this._scrollChat)},_onUserListToggle:function(){Dispatcher.sendAction("TOGGLE_CHAT_USERLIST")},_addAtUname:function(e){return function(){Dispatcher.sendAction("ADD_AT_USERNAME",e),$("#chat-input").focus().select()}},render:function(){var e=this;return el.div({id:"chat-box"},el.div({className:"panel panel-default"},el.div({className:"panel-body"},el.ul({className:"chat-list list-unstyled",ref:"chatListRef"},chatStore.state.messages.toArray().map(function(t){return el.li({key:t.id},el.span({style:{fontFamily:"monospace"}},helpers.formatDateToTime(t.created_at)," "),t.user?helpers.roleToLabelElement(t.user.role):"",t.user?" ":"",el.code({disabled:!worldStore.state.user,onClick:e._addAtUname(t.user.uname)},t.user?t.user.uname:"SYSTEM :: "+t.text),t.user?el.span(null," "+t.text):"")}))),el.div({className:"panel-footer"},React.createElement(ChatBoxInput,null))),el.p({className:"text-right text-muted",style:{marginTop:"-15px"}},"Users online: "+Object.keys(chatStore.state.userList).length+" ",el.button({className:"btn btn-default btn-xs",onClick:this._onUserListToggle},chatStore.state.showUserList?"Hide":"Show")),chatStore.state.showUserList?React.createElement(ChatUserList,null):"")}}),ChatBox=React.createClass({displayName:"ChatBox",_onStoreChange:function(){this.forceUpdate()},_onNewMessage:function(){var e=this.refs.chatListRef.getDOMNode(),t=function(){var t=e.scrollHeight-($(e).scrollTop()+$(e).innerHeight());return console.log("DistanceFromBottom:",t),100>=t};t()&&this._scrollChat()},_scrollChat:function(){var e=this.refs.chatListRef.getDOMNode();$(e).scrollTop(e.scrollHeight)},componentDidMount:function(){chatStore.on("change",this._onStoreChange),chatStore.on("new_message",this._onNewMessage),chatStore.on("init",this._scrollChat)},componentWillUnmount:function(){chatStore.off("change",this._onStoreChange),chatStore.off("new_message",this._onNewMessage),chatStore.off("init",this._scrollChat)},_onUserListToggle:function(){Dispatcher.sendAction("TOGGLE_CHAT_USERLIST")},_addAtUname:function(e){return function(){Dispatcher.sendAction("ADD_AT_USERNAME",e),$("#chat-input").focus().select()}},render:function(){var e=this;return el.div({id:"chat-box"},el.div({className:"panel-chatbox-custom panel-default-custom"},el.div({className:"panel-body-custom"},el.ul({className:"list-unstyled chat-list-custom",ref:"chatListRef"},chatStore.state.messages.toArray().map(function(t){return el.li({key:t.id},el.code({className:"chat-uname",disabled:!worldStore.state.user,onClick:e._addAtUname(t.user.uname)},t.user?t.user.uname:"SYSTEM :: "+t.text),t.user?t.text.split("\\n").map(function(e,t){return el.span({key:t},el.span({className:"chat-msg"}," "+e),el.br(null))}):"")}))),el.div({className:"chat-input-panel"},React.createElement(ChatBoxInput,null))))}}),BetBoxChance=React.createClass({displayName:"BetBoxChance",_onStoreChange:function(){this.forceUpdate()},componentDidMount:function(){betStore.on("change",this._onStoreChange),worldStore.on("change",this._onStoreChange)},componentWillUnmount:function(){betStore.off("change",this._onStoreChange),worldStore.off("change",this._onStoreChange)},render:function(){var e,t=helpers.multiplierToWinProb(betStore.state.multiplier.num),n=betStore.state.multiplier.error||betStore.state.wager.error;return e=n?el.span({className:"text"}," --"):el.span({className:"text"}," "+(100*t).toFixed(2).toString()+"%"),el.div({},el.span({className:"text",style:{fontWeight:"bold"}},"Chance:"),e)}}),BetBoxProfit=React.createClass({displayName:"BetBoxProfit",_onStoreChange:function(){this.forceUpdate()},componentDidMount:function(){betStore.on("change",this._onStoreChange),worldStore.on("change",this._onStoreChange)},componentWillUnmount:function(){betStore.off("change",this._onStoreChange),worldStore.off("change",this._onStoreChange)},render:function(){var e,t=betStore.state.wager.num*(betStore.state.multiplier.num-1);return e=betStore.state.multiplier.error||betStore.state.wager.error?el.span({className:"text"},"--"):el.span({className:"text",style:{color:"#39b54a"}},"+"+t.toFixed(2)),el.div(null,el.span({className:"text",style:{fontWeight:"bold"}},"Profit: "),e)}}),BetBoxMaxProfit=React.createClass({displayName:"BetBoxMaxProfit",_onStoreChange:function(){this.forceUpdate()},componentDidMount:function(){betStore.on("change",this._onStoreChange),worldStore.on("change",this._onStoreChange)},componentWillUnmount:function(){betStore.off("change",this._onStoreChange),worldStore.off("change",this._onStoreChange)},render:function(){var e,t=worldStore.state.mpBankRoll*config.house_edge/1e8;return e=worldStore.state.accessToken?el.span({className:"text"},"~"+helpers.numberWithCommas(t.toFixed(1))+" BTC"):el.span({className:"text"},"--"),el.div(null,el.span({className:"text",style:{fontWeight:"bold"}},"Max Profit: "),e)}}),BetBoxClientSeed=React.createClass({displayName:"BetBoxClientSeed",_onStoreChange:function(){this.forceUpdate()},componentDidMount:function(){betStore.on("change",this._onStoreChange),worldStore.on("change",this._onStoreChange)},componentWillUnmount:function(){betStore.off("change",this._onStoreChange),worldStore.off("change",this._onStoreChange)},_onClientSeedChange:function(e){var t=e.target.value;Dispatcher.sendAction("UPDATE_CLIENT_SEED",{str:t}),this._validateClientSeed(t)},_validateClientSeed:function(e){var t=parseInt(e),n=/^(\d*)?$/;isNaN(t)||!n.test(e)?Dispatcher.sendAction("UPDATE_CLIENT_SEED",{error:"INVALID_CLIENT_SEED"}):t>Math.pow(2,32)-1?Dispatcher.sendAction("UPDATE_CLIENT_SEED",{error:"CLIENT_SEED_TOO_HIGH"}):Dispatcher.sendAction("UPDATE_CLIENT_SEED",{num:t,error:null})},_randomizeSeed:function(){var e=Math.floor(Math.random()*(Math.pow(2,32)-1));Dispatcher.sendAction("UPDATE_CLIENT_SEED",{str:e.toString(),num:e,error:null})},_randomizeLock:function(){Dispatcher.sendAction("TOGGLE_LOCK_RND")},render:function(){return el.div({className:"form-group"},el.p({className:"text"},el.strong({style:betStore.state.clientseed.error?{color:"red"}:{}},"Client Seed:")),el.div({className:"input-group"},el.span({className:"input-group-btn"},el.button({type:"button",className:"btn btn-primary btn-md",onClick:this._randomizeSeed,disabled:betStore.state.clientseed.randomizelock?!0:!1},el.span({className:betStore.state.clientseed.randomizelock?"label-success no-shadow":""},"RND"))),el.input({type:"text",value:betStore.state.clientseed.str,className:"form-control input-md",onChange:this._onClientSeedChange,disabled:!!worldStore.state.isLoading}),el.span({className:"input-group-btn"},el.button({type:"button",className:"btn btn-primary btn-md",onClick:this._randomizeLock},el.span({className:betStore.state.clientseed.randomizelock?"label-success no-shadow":""},"LOCK")))))}}),BetBoxMultiplier=React.createClass({displayName:"BetBoxMultiplier",_onStoreChange:function(){this.forceUpdate()},componentDidMount:function(){betStore.on("change",this._onStoreChange),worldStore.on("change",this._onStoreChange)},componentWillUnmount:function(){
betStore.off("change",this._onStoreChange),worldStore.off("change",this._onStoreChange)},_validateMultiplier:function(e){var t=parseFloat(e,10),n=/^(\d*\.)?\d+$/;isNaN(t)||!n.test(e)?Dispatcher.sendAction("UPDATE_MULTIPLIER",{error:"INVALID_MULTIPLIER"}):1.01>t?Dispatcher.sendAction("UPDATE_MULTIPLIER",{error:"MULTIPLIER_TOO_LOW"}):t>9900?Dispatcher.sendAction("UPDATE_MULTIPLIER",{error:"MULTIPLIER_TOO_HIGH"}):helpers.getPrecision(t)>2?Dispatcher.sendAction("UPDATE_MULTIPLIER",{error:"MULTIPLIER_TOO_PRECISE"}):Dispatcher.sendAction("UPDATE_MULTIPLIER",{num:t,error:null})},_onMultiplierChange:function(e){console.log("Multiplier changed");var t=e.target.value;console.log("You entered",t,"as your multiplier"),Dispatcher.sendAction("UPDATE_MULTIPLIER",{str:t}),this._validateMultiplier(t)},render:function(){return el.div({className:"form-group"},el.p({className:"text"},el.strong({style:betStore.state.multiplier.error?{color:"red"}:{}},"Multiplier:")),el.div({className:"input-group input-group-md"},el.input({id:"bot-multi",type:"text",value:betStore.state.multiplier.str,className:"form-control",onChange:this._onMultiplierChange,onClick:this._onMultiplierChange,disabled:!!worldStore.state.isLoading}),el.span({className:"input-group-addon"},"x")))}}),BetBoxWagerOld=React.createClass({displayName:"BetBoxWagerOld",_onStoreChange:function(){this.forceUpdate()},_onBalanceChange:function(){Dispatcher.sendAction("UPDATE_WAGER",{})},componentDidMount:function(){betStore.on("change",this._onStoreChange),worldStore.on("change",this._onStoreChange),worldStore.on("user_update",this._onBalanceChange)},componentWillUnmount:function(){betStore.off("change",this._onStoreChange),worldStore.off("change",this._onStoreChange),worldStore.off("user_update",this._onBalanceChange)},_onWagerChange:function(e){var t=e.target.value;Dispatcher.sendAction("UPDATE_WAGER",{str:t})},_onHalveWager:function(){var e=Math.round(betStore.state.wager.num/2);Dispatcher.sendAction("UPDATE_WAGER",{str:e.toString()})},_onDoubleWager:function(){var e=2*betStore.state.wager.num;Dispatcher.sendAction("UPDATE_WAGER",{str:e.toString()})},_onMaxWager:function(){var e;e=worldStore.state.user?Math.floor(worldStore.state.user.balance/100):42e3,Dispatcher.sendAction("UPDATE_WAGER",{str:e.toString()})},render:function(){var e={borderBottomLeftRadius:"0",borderBottomRightRadius:"0"},t={borderTopLeftRadius:"0"},n={borderTopRightRadius:"0"};return el.div({className:"form-group"},el.p({className:"text"},el.strong(betStore.state.wager.error?{style:{color:"red"}}:null,"Wager:")),el.div({className:"input-group"},el.input({id:"bot-wager",value:betStore.state.wager.str,type:"text",className:"form-control input-md",style:e,onChange:this._onWagerChange,onClick:this._onWagerChange,disabled:!!worldStore.state.isLoading,placeholder:"Bits"}),el.span({className:"input-group-addon"},"bits")),el.div({className:"btn-group btn-group-justified"},el.div({className:"btn-group"},el.button({className:"btn btn-default btn-xs",type:"button",style:t,onClick:this._onHalveWager},"1/2x ",worldStore.state.hotkeysEnabled?el.kbd({className:"no-shadow"},"X"):"")),el.div({className:"btn-group"},el.button({className:"btn btn-default btn-xs",type:"button",onClick:this._onDoubleWager},"2x ",worldStore.state.hotkeysEnabled?el.kbd({className:"no-shadow"},"C"):"")),el.div({className:"btn-group"},el.button({className:"btn btn-default btn-xs",type:"button",style:n,onClick:this._onMaxWager},"Max"))))}}),BetBoxWager=React.createClass({displayName:"BetBoxWager",_onStoreChange:function(){this.forceUpdate()},_onBalanceChange:function(){Dispatcher.sendAction("UPDATE_WAGER",{})},componentDidMount:function(){betStore.on("change",this._onStoreChange),worldStore.on("change",this._onStoreChange),worldStore.on("user_update",this._onBalanceChange)},componentWillUnmount:function(){betStore.off("change",this._onStoreChange),worldStore.off("change",this._onStoreChange),worldStore.off("user_update",this._onBalanceChange)},_onWagerChange:function(e){var t=e.target.value;Dispatcher.sendAction("UPDATE_WAGER",{str:t})},_onHalveWager:function(){var e=Math.round(betStore.state.wager.num/2);Dispatcher.sendAction("UPDATE_WAGER",{str:e.toString()})},_onDoubleWager:function(){var e=2*betStore.state.wager.num;Dispatcher.sendAction("UPDATE_WAGER",{str:e.toString()})},_onMaxWager:function(){var e;e=worldStore.state.user?Math.floor(worldStore.state.user.balance/100):42e3,Dispatcher.sendAction("UPDATE_WAGER",{str:e.toString()})},render:function(){var e={borderBottomLeftRadius:"0",borderBottomRightRadius:"0"},t={borderTopLeftRadius:"0"},n={borderTopRightRadius:"0"};return el.div({className:"form-group"},el.p({className:"text"},el.strong(betStore.state.wager.error?{style:{color:"red"}}:null,"Wager:")),el.div({className:"input-group input-group-md"},el.input({id:"bot-wager",value:betStore.state.wager.str,type:"text",className:"form-control",style:e,onChange:this._onWagerChange,onClick:this._onWagerChange,disabled:!!worldStore.state.isLoading,placeholder:"Bits"}),el.span({className:"input-group-addon"},"bits")),el.div({className:"btn-group btn-group-justified"},el.div({className:"btn-group"},el.button({className:"btn btn-default-custom btn-xs",type:"button",style:t,onClick:this._onHalveWager},"1/2x ",worldStore.state.hotkeysEnabled?el.kbd({className:"no-shadow"},"X"):"")),el.div({className:"btn-group"},el.button({className:"btn btn-default-custom btn-xs",type:"button",onClick:this._onDoubleWager},"2x ",worldStore.state.hotkeysEnabled?el.kbd({className:"no-shadow"},"C"):"")),el.div({className:"btn-group"},el.button({className:"btn btn-default-custom btn-xs",type:"button",style:n,onClick:this._onMaxWager},"Max"))))}}),BetBoxButton=React.createClass({displayName:"BetBoxButton",_onStoreChange:function(){this.forceUpdate()},componentDidMount:function(){worldStore.on("change",this._onStoreChange),betStore.on("change",this._onStoreChange)},componentWillUnmount:function(){worldStore.off("change",this._onStoreChange),betStore.off("change",this._onStoreChange)},getInitialState:function(){return{waitingForServer:!1}},_makeBetHandler:function(e){var t=this;return console.assert("<"===e||">"===e),function(n){console.log("Placing bet..."),t.setState({waitingForServer:!0});var a=betStore.state.nextHash;console.assert("string"==typeof a);var o=100*betStore.state.wager.num,r=betStore.state.multiplier.num,s=o*r,l=helpers.calcNumber(e,helpers.multiplierToWinProb(r)),i={wager:o,client_seed:betStore.state.clientseed.num,hash:a,cond:e,target:l,payout:s};MoneyPot.placeSimpleDiceBet(i,{success:function(t){if(console.log("Successfully placed bet:",t),t.meta={cond:e,number:l,hash:a,isFair:CryptoJS.SHA256(t.secret+"|"+t.salt).toString()===a},t.wager=o,t.uname=worldStore.state.user.uname,Dispatcher.sendAction("NEW_BET",t),Dispatcher.sendAction("SET_NEXT_HASH",t.next_hash),Dispatcher.sendAction("UPDATE_USER",{balance:worldStore.state.user.balance+t.profit}),betStore.state.clientseed.randomizelock){var n=Math.floor(Math.random()*(Math.pow(2,32)-1));Dispatcher.sendAction("UPDATE_CLIENT_SEED",{str:n.toString(),num:n,error:null})}},error:function(e){console.log("Error"),e.responseJSON&&e.responseJSON?alert(e.responseJSON.error):alert("Internal Error")},complete:function(){t.setState({waitingForServer:!1}),Dispatcher.sendAction("UPDATE_WAGER",{str:betStore.state.wager.str})}})}},render:function(){var e,t=betStore.state.wager.error||betStore.state.multiplier.error||betStore.state.clientseed.error;if(worldStore.state.isLoading)e=el.button({type:"button",disabled:!0,className:"btn btn-lg btn-block btn-default"},"Loading...");else if(t){var n={CANNOT_AFFORD_WAGER:"You cannot afford wager",INVALID_WAGER:"Invalid wager",INVALID_MULTIPLIER:"Invalid multiplier",MULTIPLIER_TOO_PRECISE:"Multiplier too precise",MULTIPLIER_TOO_HIGH:"Multiplier too high",MULTIPLIER_TOO_LOW:"Multiplier too low",INVALID_CLIENT_SEED:"Invalid client seed",CLIENT_SEED_TOO_HIGH:"Client seed too high"};e=el.button({type:"button",disabled:!0,className:"btn btn-lg btn-block btn-danger"},n[t]||"Invalid bet")}else e=worldStore.state.user?el.div({className:"row"},el.div({className:"col-xs-6"},el.button({id:"bet-hi",type:"button",className:"btn btn-lg btn-primary",onClick:this._makeBetHandler(">"),disabled:!!this.state.waitingForServer},"Bet Hi ",worldStore.state.hotkeysEnabled?el.kbd(null,"H"):"")),el.div({className:"col-xs-6"},el.button({id:"bet-lo",type:"button",className:"btn btn-lg btn-primary",onClick:this._makeBetHandler("<"),disabled:!!this.state.waitingForServer},"Bet Lo ",worldStore.state.hotkeysEnabled?el.kbd(null,"L"):""))):el.div(null," ");return el.div(null,el.div({className:"col-md-1"},this.state.waitingForServer?el.span({className:"glyphicon glyphicon-refresh rotate",style:{marginTop:"15px"}}):""),el.div({className:"col-md-10"},e),el.div({className:"col-md-1"},""))}}),HotkeyToggleOld=React.createClass({displayName:"HotkeyToggleOld",_onClick:function(){Dispatcher.sendAction("TOGGLE_HOTKEYS")},render:function(){return el.div({className:"text-center"},el.button({type:"button",className:"btn btn-default btn-sm",onClick:this._onClick,style:{marginTop:"-15px"}},"Hotkeys: ",worldStore.state.hotkeysEnabled?el.span({className:"label label-success no-shadow"},"ON"):el.span({className:"label label-default no-shadow"},"OFF")))}}),HotkeyToggle=React.createClass({displayName:"HotkeyToggle",_onStoreChange:function(){this.forceUpdate()},componentDidMount:function(){worldStore.on("change",this._onStoreChange)},componentWillUnmount:function(){worldStore.off("change",this._onStoreChange)},_onClick:function(){Dispatcher.sendAction("TOGGLE_HOTKEYS")},render:function(){return el.div({className:"text-center"},el.button({className:"btn btn-default-custom btn-sm",type:"button",onClick:this._onClick,style:{marginTop:"30px"}},"Hotkeys: ",worldStore.state.hotkeysEnabled?el.span({className:"label label-success"},"ON"):el.span({className:"label label-default"},"OFF")))}}),BetBox=React.createClass({displayName:"BetBox",_onStoreChange:function(){this.forceUpdate()},componentDidMount:function(){worldStore.on("change",this._onStoreChange)},componentWillUnmount:function(){worldStore.off("change",this._onStoreChange)},render:function(){return el.div(null,el.div({className:"panel panel-default"},el.div({className:"panel-body"},el.div({className:"row"},el.div({className:"col-xs-6"},React.createElement(BetBoxWager,null)),el.div({className:"col-xs-6"},React.createElement(BetBoxMultiplier,null)),el.div({className:"row"},el.div({className:"col-xs-12"},el.hr(null))),el.div(null,el.div({className:"col-sm-5"},el.div({className:"row"},el.div({className:"col-sm-12"},React.createElement(BetBoxProfit,null))),el.div({className:"row"},el.div({className:"col-sm-12"},React.createElement(BetBoxMaxProfit,null))),el.div({className:"row"},el.div({className:"col-sm-12"},React.createElement(BetBoxChance,null)))),el.div({className:"col-sm-7"},React.createElement(BetBoxClientSeed,null))))),el.div({className:"panel-footer clearfix"},React.createElement(BetBoxButton,null))),React.createElement(HotkeyToggle,null))}}),Tabs=React.createClass({displayName:"Tabs",_onStoreChange:function(){this.forceUpdate()},componentDidMount:function(){worldStore.on("change",this._onStoreChange)},componentWillUnmount:function(){worldStore.off("change",this._onStoreChange)},_makeTabChangeHandler:function(e){return function(){Dispatcher.sendAction("CHANGE_TAB",e)}},render:function(){return el.ul({className:"nav-custom nav-tabs-custom"},el.li({className:"ALL_BETS"===worldStore.state.currTab?"active":""},el.a({href:"javascript:void(0)",onClick:this._makeTabChangeHandler("ALL_BETS")},"All Bets")),worldStore.state.user?el.li({id:"bot-mybets",className:"MY_BETS"===worldStore.state.currTab?"active":""},el.a({href:"javascript:void(0)",onClick:this._makeTabChangeHandler("MY_BETS")},"My Bets")):"",config.recaptcha_sitekey?el.li({className:"FAUCET"===worldStore.state.currTab?"active":""},el.a({href:"javascript:void(0)",onClick:this._makeTabChangeHandler("FAUCET")},el.span(null,"Faucet "))):"",el.li({className:"INFO"===worldStore.state.currTab?"active":""},el.a({href:"javascript:void(0)",onClick:this._makeTabChangeHandler("INFO")},el.span(null,"Info "))))}}),MyBetsTabContent=React.createClass({displayName:"MyBetsTabContent",_onStoreChange:function(){this.forceUpdate()},componentDidMount:function(){worldStore.on("new_my_bet",this._onStoreChange)},componentWillUnmount:function(){worldStore.off("new_my_bet",this._onStoreChange)},render:function(){return el.div({className:"table-scroll"},el.table({id:"bot-bets",className:"table-custom table-striped-custom"},el.thead(null,el.tr(null,el.th(null,"ID"),el.th(null,"Time"),el.th(null,"Wager"),el.th(null,"Target"),el.th(null,"Roll"),el.th(null,"Profit"))),el.tbody(null,worldStore.state.bets.toArray().map(function(e){return el.tr({key:e.bet_id||e.id},el.td(null,el.a({href:config.mp_browser_uri+"/bets/"+(e.bet_id||e.id),target:"_blank"},e.bet_id||e.id)),el.td(null,helpers.formatDateToTime(e.created_at)),el.td(null,helpers.round10(e.wager/100,-2)," bits"),el.td(null,e.meta.cond+" "+e.meta.number.toFixed(2)),el.td(null,e.outcome+" ",e.meta.isFair?el.span({className:"label label-success"},"Verified"):""),el.td({style:{color:e.profit>0?"green":"red"}},e.profit>0?"+"+helpers.round10(e.profit/100,-2):helpers.round10(e.profit/100,-2)," bits"))}).reverse())))}}),InfoTabContent=React.createClass({_onStoreChange:function(){this.forceUpdate()},componentDidMount:function(){worldStore.on("change",this._onStoreChange)},componentWillUnmount:function(){worldStore.off("change",this._onStoreChange)},_makeTabChangeHandler:function(e){return function(){Dispatcher.sendAction("CHANGE_TAB",e)}},render:function(){return el.div({className:"table-scroll"},el.div({className:"panel-info-custom panel-primary"},el.div({className:"panel-body"},el.span({className:"h4 text-left"},"Welcome to Awesome Dice"),el.p(null,"Awesome Dice is a bitcoin dice website, where you are having the chance to win big, and giving you a great gambling experience."),el.span({className:"h4 text-left"},"How do I start playing?"),el.p(null,"Awesome Dice is powered by ",el.a({href:"https://www.moneypot.com"},el.span(null,"MoneyPot ")),". MoneyPot is a bitcoin wallet, which Awesome Dice is integrated into. First you ",el.a({href:"https://www.moneypot.com/register"},el.span(null,"register "))," an account on MoneyPot. After that you can ",el.a({href:"https://www.moneypot.com/login"},el.span(null,"login ")),". Then go to the ",el.a({href:"https://www.moneypot.com/apps/1005-awesome-dice"},el.span(null,"Awesome Dice "))," page on MoneyPot and enable the app. Finally you can go back to ",el.a({href:"http://awesomedice.net"},el.span(null,"Awesome Dice ")),", make a deposit and play!"),el.span({className:"h4 text-left"},"Can I try this website for free?"),el.p(null,"Of course you can. A faucet is available on this website, just click on the ",el.a({href:"javascript:void(0)",onClick:this._makeTabChangeHandler("FAUCET")},el.span(null,"Faucet ")),"tab. You can claim 2 bits every 5 minutes."),el.span({className:"h4 text-left"},"Does Awesome Dice have an autobet option?"),el.p(null,"The ",el.a({href:"http://themadroller.com"},el.span(null,"MadRollers's dice playing bot"))," is available here. The bot is controlled by JavaScript code you enter into the editor. If you can think of it, the bot can do it. If you like the bot, don't forget to make a donation to it's creator. BTC: 15F1t1d3ePWEsV8qoAV58NKnj6Fydf9RVi"),el.p(null,"The following code example of a betting system is known as martingale."),el.div({className:"row"},el.div({className:"col-sm-4"},el.p(null,"'Startup Bot Code Editor': This code is executed once when you first press the Execute button on the 'Main Bot Code Editor' and then executes the first roll.")),el.div({className:"col-sm-8"},el.p(null,"'Main Bot Code Editor': This is where your magic happens. Any code in here will be run after each roll."))),el.div({className:"row"},el.div({className:"col-sm-4"},el.pre(null,"botBaseBet=1.00000000;\nbotBaseGame=49.00;\nbotBaseMulti=2;\nbotBaseType=0;\nresetToBase();")),el.div({className:"col-sm-8"},el.pre(null,"if(botDidWin){\n	resetToBase();\n} else {\n	botCurrBet = (botCurrBet * botCurrMulti);\n}"))),el.p(null,"Helper functions:"),el.ul(null,el.li(null,"resetToBase() - reset bet setting to settings in Startup Code"),el.li(null,"pauseBot(pauseAmount) - pause the bot for xxx ms"),el.li(null,"flipGame() - toggles hi/lo bet"),el.li(null,"stopBotCode() - stops the bot"),el.li(null,"rand(min,max) - get a random number between min and max"),el.li(null,"userLabel(ID,string) - label user variables in the 'System Variables' window"),el.li(null,"userValue(ID,value) - give user variables a value in the 'System Variables' window")))))}}),FaucetTabContent=React.createClass({displayName:"FaucetTabContent",getInitialState:function(){return{faucetState:"SHOW_RECAPTCHA",claimAmount:void 0}},_renderRecaptcha:function(){worldStore.state.grecaptcha.render("recaptcha-target",{sitekey:config.recaptcha_sitekey,callback:this._onRecaptchaSubmit})},_onRecaptchaSubmit:function(e){var t=this;console.log("recaptcha submitted: ",e),t.setState({faucetState:"WAITING_FOR_SERVER"}),MoneyPot.claimFaucet(e,{success:function(e){Dispatcher.sendAction("UPDATE_USER",{balance:worldStore.state.user.balance+e.amount}),t.setState({faucetState:"SUCCESSFULLY_CLAIMED",claimAmount:e.amount})},error:function(e,n,a){e.responseJSON&&"FAUCET_ALREADY_CLAIMED"===e.responseJSON.error&&t.setState({faucetState:"ALREADY_CLAIMED"})}})},componentDidMount:function(){worldStore.state.grecaptcha&&this._renderRecaptcha(),worldStore.on("grecaptcha_loaded",this._renderRecaptcha)},componentWillUnmount:function(){worldStore.off("grecaptcha_loaded",this._renderRecaptcha)},render:function(){if(!worldStore.state.user)return el.p({className:"lead"},"You must login to claim faucet");var e;switch(this.state.faucetState){case"SHOW_RECAPTCHA":e=el.div({id:"recaptcha-target"},worldStore.state.grecaptcha?"":"Loading...");break;case"SUCCESSFULLY_CLAIMED":e=el.div(null,"Successfully claimed "+this.state.claimAmount/100+" bits. You can claim again in 5 minutes.");break;case"ALREADY_CLAIMED":e=el.div(null,"ALREADY_CLAIMED");break;case"WAITING_FOR_SERVER":e=el.div(null,"WAITING_FOR_SERVER");break;default:return void alert("Unhandled faucet state")}return el.div(null,e)}}),BetRow=React.createClass({displayName:"BetRow",render:function(){var e=this.props.bet;return el.tr({},el.td(null,el.a({href:config.mp_browser_uri+"/bets/"+(e.bet_id||e.id),target:"_blank"},e.bet_id||e.id)),el.td(null,helpers.formatDateToTime(e.created_at)),el.td(null,el.a({href:config.mp_browser_uri+"/users/"+e.uname,target:"_blank"},e.uname)),el.td(null,helpers.round10(e.wager/100,-2)," bits"),el.td(null,e.cond+e.target.toFixed(2)),el.td(null,e.outcome),el.td({style:{color:e.profit>0?"green":"red"}},e.profit>0?"+"+helpers.round10(e.profit/100,-2):helpers.round10(e.profit/100,-2)," bits"))}}),AllBetsTabContent=React.createClass({displayName:"AllBetsTabContent",_onStoreChange:function(){this.forceUpdate()},componentDidMount:function(){worldStore.on("new_all_bet",this._onStoreChange)},componentWillUnmount:function(){worldStore.off("new_all_bet",this._onStoreChange)},render:function(){return el.div({className:"table-scroll"},el.table({className:"table-custom table-striped-custom"},el.thead(null,el.tr(null,el.th(null,"ID"),el.th(null,"Time"),el.th(null,"User"),el.th(null,"Wager"),el.th(null,"Target"),el.th(null,"Roll"),el.th(null,"Profit"))),el.tbody(null,worldStore.state.allBets.toArray().map(function(e){return React.createElement(BetRow,{bet:e,key:e.bet_id||e.id})}).reverse())))}}),TabContent=React.createClass({displayName:"TabContent",_onStoreChange:function(){this.forceUpdate()},componentDidMount:function(){worldStore.on("change",this._onStoreChange)},componentWillUnmount:function(){worldStore.off("change",this._onStoreChange)},render:function(){switch(worldStore.state.currTab){case"INFO":return React.createElement(InfoTabContent,null);case"FAUCET":return React.createElement(FaucetTabContent,null);case"MY_BETS":return React.createElement(MyBetsTabContent,null);case"ALL_BETS":return React.createElement(AllBetsTabContent,null);default:alert("Unsupported currTab value: ",worldStore.state.currTab)}}}),makeTile=function(e,t,n){return el.div({className:"module "+e+" "+t},el.div({className:"module-background"},el.img({src:"/assets/images/background-blur.jpg"})),el.div({className:"module-inner",style:{padding:"5px"}},n()))},BetBoxInfoTile=React.createClass({displayName:"BetBoxInfoTile",render:function(){return makeTile("height-x1","width-x1",function(){return el.div(null,React.createElement(BetBoxProfit,null),React.createElement(BetBoxMaxProfit,null))})}}),BetBoxInputTile=React.createClass({displayName:"BetBoxInputTile",render:function(){return makeTile("height-x3","width-x1",function(){return el.div({className:"tile"},el.div({className:"tile-row-inner"},el.div({className:"row"},el.div({className:"col-sm-7"},el.div({style:{maxWidth:"200px"}},React.createElement(BetBoxWager,null))),el.div({className:"col-sm-5"},el.div({style:{marginLeft:"0px"}},React.createElement(HotkeyToggle,null)))),el.div({className:"row"},el.div({className:"col-sm-6",style:{marginLeft:"-15px"}},React.createElement(BetBoxMultiplier,null)),el.div({className:"col-sm-6"},el.div({className:"row"},React.createElement(BetBoxChance,null)),el.div({className:"row"},React.createElement(BetBoxProfit,null)),el.div({className:"row"},React.createElement(BetBoxMaxProfit,null)))),el.div({className:"row"},el.div({style:{maxWidth:"300px"}},React.createElement(BetBoxClientSeed,null))),el.div({className:"row",style:{marginTop:"15px"}},React.createElement(BetBoxButton,null))))})}}),ChatBoxTile=React.createClass({displayName:"ChatBoxTile",render:function(){return makeTile("height-x3","width-x1",function(){return el.div(null,React.createElement(ChatBox,null))})}}),UserBoxTile=React.createClass({displayName:"UserBoxTile",render:function(){return makeTile("height-x1","width-x1",function(){return el.div({className:"tile"},React.createElement(UserBox,null),React.createElement(BalanceBox,null))})}}),BalanceBoxTile=React.createClass({displayName:"BalanceBoxTile",render:function(){return makeTile("height-x1","width-x1",function(){return el.div(null,React.createElement(BalanceBox,null))})}}),TabsTile=React.createClass({displayName:"TabsTile",render:function(){return makeTile("height-x4","width-x2",function(){return el.div(null,React.createElement(Tabs,null),React.createElement(TabContent,null))})}}),LogoTile=React.createClass({displayName:"TabsTile",render:function(){return makeTile("height-x1","width-x1",function(){return el.div(null,React.createElement(Logo,null))})}}),App=React.createClass({displayName:"App",render:function(){return el.div(null,React.createElement(LogoTile,null),React.createElement(UserBoxTile,null),React.createElement(ChatBoxTile,null),React.createElement(TabsTile,null),React.createElement(BetBoxInputTile,null))}});if(React.render(React.createElement(App,null),document.getElementById("app")),worldStore.state.accessToken){MoneyPot.getTokenInfo({success:function(e){console.log("Successfully loaded user from tokens endpoint",e);var t=e.auth.user;Dispatcher.sendAction("USER_LOGIN",t)},error:function(e){console.log("Error:",e)},complete:function(){Dispatcher.sendAction("STOP_LOADING"),connectToChatServer()}}),MoneyPot.generateBetHash({success:function(e){Dispatcher.sendAction("SET_NEXT_HASH",e.hash)}});var params={app_id:config.app_id,limit:config.bet_buffer_size};MoneyPot.listBets(params,{success:function(e){console.log("[MoneyPot.listBets]:",e),Dispatcher.sendAction("INIT_ALL_BETS",e.reverse())},error:function(e){console.error("[MoneyPot.listBets] Error:",e)}}),Dispatcher.sendAction("UPDATE_MP_BANKROLL")}else Dispatcher.sendAction("STOP_LOADING"),connectToChatServer();$(function(){$("#vertical-ticker").vTicker()}),$(document).on("keydown",function(e){var t=72,n=76,a=67,o=88,r=e.which;if(worldStore.state.hotkeysEnabled&&(r===t||r===n||r===o||r===a))switch(e.stopPropagation(),e.preventDefault(),r){case a:var s=2*betStore.state.wager.num;Dispatcher.sendAction("UPDATE_WAGER",{num:s,str:s.toString()});break;case o:var l=Math.floor(betStore.state.wager.num/2);Dispatcher.sendAction("UPDATE_WAGER",{num:l,str:l.toString()});break;case n:$("#bet-lo").click();break;case t:$("#bet-hi").click();break;default:return}}),window.addEventListener("message",function(e){e.origin===config.mp_browser_uri&&"UPDATE_BALANCE"===e.data&&Dispatcher.sendAction("START_REFRESHING_USER")},!1),window.setInterval(function(){worldStore.state.accessToken&&Dispatcher.sendAction("UPDATE_MP_BANKROLL")},6e4);